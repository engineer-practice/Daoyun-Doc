webpackJsonp([7],{XcIJ:function(e,t,o){var r=o("cMoN");"string"==typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);o("rjj0")("088b0e64",r,!0)},bWfh:function(e,t,o){var r=o("qvzg");"string"==typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);o("rjj0")("cdfbbcc0",r,!0)},cMoN:function(e,t,o){(e.exports=o("FZ+f")(!1)).push([e.i,"\n.el-table__header {\r\n  width: auto !important;\n}\n.el-table__body {\r\n  width: auto !important;\n}\n.app-container {\r\n  background-color: #f0f2f5;\r\n  min-height: 100vh;\r\n  height: 100%;\n}\n.form-style {\r\n  background: #fff;\r\n  padding: 20px;\r\n  min-height: 85vh;\n}\r\n",""])},qvzg:function(e,t,o){(e.exports=o("FZ+f")(!1)).push([e.i,"\n.el-pagination[data-v-d3c96944] {\r\n  text-align: center !important;\r\n  margin: 20px 0 !important;\n}\r\n",""])},smzg:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o("mvHQ"),l=o.n(r),a={data:function(){return{list:[],AllData:[],listLoading:!1,multipleSelection:[],dialogFormVisible:!1,ruleForm:{name:"",sex:"0",roleId:"0",telephone:""},roleAu:!1,rules:{name:[{required:!0,message:"请输入用户名称",trigger:"blur"}],roleId:[{required:!0,message:"请选择角色",trigger:"change"}],telephone:[{required:!0,message:"请输入手机号码",trigger:"blur"},{message:"请输入正确的手机号码",trigger:["blur","change"]}]},totalNum:0,title:"新增用户",pageSize:10,formInline:{username:"",state:""},page:1}},mounted:function(){this.getStateAu()},created:function(){this.showUserInfo(this.page),this.getStateAu()},methods:{filterState:function(e){return"0"==e?"正常":"禁用"},btnState:function(e){return"0"==e?"primary":"danger"},getStateAu:function(){var e=JSON.parse(localStorage.getItem("authority"));if(e)for(var t=0;t<e.length;t++)"4"==e[t]&&(this.roleAu=!0)},changeState:function(e){var t=this,o={telephone:e.telephone},r=0,a=JSON.parse(localStorage.getItem("authority"));if(a)for(var n=0;n<a.length;n++)"5"==a[n]&&(r=1);var i=0;if(a)for(n=0;n<a.length;n++)"8"==a[n]&&(i=1);!r&&1==e.state||!i&&0==e.state?(console.log("patch/userdata = "+l()(o)),this.$http.patch("/api/user",null,{params:o}).then(function(o){"1"==o.data.respCode?(t.$alert("状态修改成功","成功",{confirmButtonText:"确定"}),e.state=!e.state,t.showUserInfo(t.page)):(t.$alert(o.data.respCode,"失败",{confirmButtonText:"确定"}),t.showUserInfo(t.page)),t.listLoading=!1},function(e){t.$router.push({path:"/"+e})})):0==e.state?this.$alert("你没有禁用用户状态权限",{confirmButtonText:"确定"}):this.$alert("你没有恢复用户状态权限",{confirmButtonText:"确定"})},resetPass:function(e){var t=this,o=0,r=JSON.parse(localStorage.getItem("authority"));if(r)for(var l=0;l<r.length;l++)"6"==r[l]&&(o=1);o?this.$alert("你没有重置密码权限",{confirmButtonText:"确定"}):(console.log("currow.telephone = "+e.telephone),this.$http.put("/api/user/resetPassword?email="+e.telephone).then(function(e){"1"==e.data.respCode?t.$alert("密码重置成功","成功",{confirmButtonText:"确定"}):t.$alert(e.data.respCode,"失败",{confirmButtonText:"确定"})}))},handleSelectionChange:function(e){this.multipleSelection=e},deleteData:function(){var e=this,t=0,o=JSON.parse(localStorage.getItem("authority"));if(o)for(var r=0;r<o.length;r++)"2"==o[r]&&(t=1);if(t)this.$alert("你没有删除用户权限",{confirmButtonText:"确定"});else if(0==this.multipleSelection.length)this.$alert("请至少选中一条数据","批量删除",{confirmButtonText:"确定"});else{var a=[];for(var r in this.multipleSelection)a.push(this.multipleSelection[r].telephone);this.$confirm("确定要删除选择的用户？","删除用户",{confirmButtonText:"确定",cancelButtonText:"取消",type:"info"}).then(function(){var t=a;console.log("deleteData = "+l()(t)),e.$http.delete("/api/user?del_list="+t).then(function(t){"1"==t.data.respCode?(e.$alert("用户删除成功","成功",{confirmButtonText:"确定"}),e.page=1,e.showUserInfo(e.page)):(e.$alert(t.data.respCode,"失败",{confirmButtonText:"确定"}),e.showUserInfo(e.page)),e.listLoading=!1},function(t){e.$router.push({path:"/"+t})})}).catch(function(){})}},searchData:function(){var e=this,t=0,o=JSON.parse(localStorage.getItem("authority"));if(o)for(var r=0;r<o.length;r++)"7"==o[r]&&(t=1);if(t)this.$alert("你没有查询用户权限",{confirmButtonText:"确定"});else{this.list=[],this.listLoading=!0;var l=localStorage.getItem("roleId");""==this.formInline.username&&""==this.formInline.state?this.showUserInfo(this.page):(this.page=1,l=1,this.$http.get("/api/user?page="+this.page+"&state="+this.formInline.state+"&name="+this.formInline.username+"&size=10&roleId="+l).then(function(t){e.listLoading=!1,0!=e.totalNum&&(e.list=t.data.dataList)},function(t){e.$router.push({path:"/"+t})}))}},showUserInfo:function(e){var t=this;this.list=[],this.listLoading=!0,this.page=e;this.page,localStorage.getItem("roleId");console.log("this.page = "+this.page),console.log("this.roldId = 1");this.$http.get("/api/user?page="+this.page+"&state=&name=&roleId=1&size=10").then(function(e){console.log("succeed succeed succeed succeed succeed"),console.log("Uersres.data = "+l()(e.data)),t.list=e.data.dataList,t.listLoading=!1,t.totalNum=e.data.total,0!=t.totalNum&&(t.list=e.data.dataList)},function(e){t.$router.push({path:"/"+e})})},reset:function(){this.ruleForm.name="",this.ruleForm.sex="1",this.ruleForm.roleId="0",this.ruleForm.telephone=""},addData:function(){var e=0,t=JSON.parse(localStorage.getItem("authority"));if(t)for(var o=0;o<t.length;o++)"1"==t[o]&&(e=1);e?this.$alert("你没有新增用户权限",{confirmButtonText:"确定"}):(this.reset(),this.dialogFormVisible=!0,this.title="新增用户")},submitForm:function(e){var t=this;this.$refs[e].validate(function(e){if(e)if(t.dialogFormVisible=!1,"新增用户"==t.title){var o={telephone:t.ruleForm.telephone,name:t.ruleForm.name,roleId:t.ruleForm.roleId,sex:t.ruleForm.sex};t.$http.post("/api/user",o).then(function(e){"1"==e.data.respCode?(t.$alert("用户添加成功","成功",{confirmButtonText:"确定"}),t.showUserInfo(t.page)):(t.$alert(e.data.respCode,"失败",{confirmButtonText:"确定"}),t.showUserInfo(t.page)),t.listLoading=!1},function(e){t.$router.push({path:"/"+e})})}else{o={name:t.ruleForm.name,sex:t.ruleForm.sex,roleId:t.ruleForm.roleId,telephone:t.ruleForm.telephone};t.$http.put("/api/user",o).then(function(e){"1"==e.data.respCode?(t.$alert("用户修改成功","成功",{confirmButtonText:"确定"}),t.showUserInfo(t.page)):(t.$alert(e.data.respCode,"失败",{confirmButtonText:"确定"}),t.showUserInfo(t.page)),t.listLoading=!1},function(e){t.$router.push({path:"/"+e})})}})},resetForm:function(e){this.dialogFormVisible=!1,this.$refs[e].resetFields(),this.reset(),this.showUserInfo(this.page)},handleCurrentChange:function(e){console.log(e),this.page=e,this.showUserInfo(this.page)},resetData:function(){this.formInline.username="",this.formInline.state="",this.page=1,this.showUserInfo(this.page)},editData:function(e){this.getStateAu();var t=0,o=JSON.parse(localStorage.getItem("authority"));if(console.log(o),o)for(var r=0;r<o.length;r++)"3"==o[r]&&(t=1);t?this.$alert("你没有编辑用户权限",{confirmButtonText:"确定"}):(this.ruleForm=e,this.ruleForm.sex=this.ruleForm.sex.toString(),this.ruleForm.roleId=this.ruleForm.roleId.toString(),this.title="修改用户信息",this.dialogFormVisible=!0)},permissionAssign:function(e){this.$router.push({path:"/userManage/permissionAssignment",query:{username:e.name}})}}},n={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"app-container"},[o("div",{staticClass:"form-style"},[o("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:e.formInline}},[o("el-form-item",[o("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-plus"},on:{click:function(t){e.addData()}}},[e._v("新增")])],1),e._v(" "),o("el-form-item",[o("el-button",{attrs:{type:"danger",size:"small",icon:"el-icon-delete"},on:{click:function(t){e.deleteData()}}},[e._v("删除")])],1),e._v(" "),o("el-form-item",{staticStyle:{float:"right"}},[o("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){e.resetData()}}},[e._v("重置")])],1),e._v(" "),o("el-form-item",{staticStyle:{float:"right"}},[o("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){e.searchData()}}},[e._v("查询")])],1),e._v(" "),o("el-form-item",{staticStyle:{float:"right"},attrs:{label:"状态："}},[o("el-select",{attrs:{placeholder:"请选择状态",size:"small"},model:{value:e.formInline.state,callback:function(t){e.$set(e.formInline,"state",t)},expression:"formInline.state"}},[o("el-option",{attrs:{label:"正常",value:"0"}}),e._v(" "),o("el-option",{attrs:{label:"禁用",value:"1"}})],1)],1),e._v(" "),o("el-form-item",{staticStyle:{float:"right"},attrs:{label:"用户名："}},[o("el-input",{attrs:{placeholder:"请输入用户名",size:"small"},model:{value:e.formInline.username,callback:function(t){e.$set(e.formInline,"username",t)},expression:"formInline.username"}})],1)],1),e._v(" "),o("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:e.list,"element-loading-text":"Loading",fit:"","highlight-current-row":"","tooltip-effect":"dark","header-cell-style":{background:"#eef1f6",color:"#606266"}},on:{"selection-change":e.handleSelectionChange}},[o("el-table-column",{attrs:{type:"selection",width:"50"}}),e._v(" "),o("el-table-column",{attrs:{label:"序号",type:"index",width:"50",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("span",[e._v(e._s((e.page-1)*e.pageSize+t.$index+1))])]}}])}),e._v(" "),o("el-table-column",{attrs:{label:"用户名","min-width":"80",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("span",[e._v(e._s(t.row.name))])]}}])}),e._v(" "),o("el-table-column",{attrs:{label:"性别","min-width":"50",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return["1"==t.row.sex?o("span",[e._v("男")]):e._e(),e._v(" "),"0"==t.row.sex?o("span",[e._v("女")]):e._e()]}}])}),e._v(" "),o("el-table-column",{attrs:{label:"手机号码","min-width":"100",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("span",[e._v(e._s(t.row.telephone))])]}}])}),e._v(" "),o("el-table-column",{attrs:{label:"角色","min-width":"100",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return["0"==t.row.roleId?o("span",[e._v("教师")]):e._e(),e._v(" "),"1"==t.row.roleId?o("span",[e._v("管理员")]):e._e(),e._v(" "),"2"==t.row.roleId?o("span",[e._v("超级管理员")]):e._e()]}}])}),e._v(" "),o("el-table-column",{attrs:{label:"所属机构","min-width":"80",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("span",[e._v(e._s(t.row.schoolName))])]}}])}),e._v(" "),o("el-table-column",{attrs:{label:"状态","min-width":"50",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-button",{attrs:{type:e.btnState(t.row.state),plain:"",size:"small"},on:{click:function(o){e.changeState(t.row)}}},[e._v(e._s(e.filterState(t.row.state)))])]}}])}),e._v(" "),o("el-table-column",{attrs:{align:"center",label:"操作","min-width":"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("div",[o("el-link",{attrs:{type:"primary"},on:{click:function(o){e.editData(t.row)}}},[e._v("编辑")]),e._v(" "),o("el-divider",{attrs:{direction:"vertical"}}),e._v(" "),o("el-link",{attrs:{type:"danger"},on:{click:function(o){e.resetPass(t.row)}}},[e._v("重置密码")])],1)]}}])})],1),e._v(" "),0!=e.totalNum?o("el-pagination",{attrs:{background:"",layout:"total, prev, pager, next",total:e.totalNum,"page-size":e.pageSize},on:{"current-change":e.handleCurrentChange}}):e._e()],1),e._v(" "),o("el-dialog",{attrs:{title:e.title,visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[o("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"100px"}},[o("el-form-item",{attrs:{label:"手机号码",prop:"telephone"}},[o("el-input",{attrs:{disabled:"修改用户信息"==e.title,placeholder:"请输入手机号码"},model:{value:e.ruleForm.telephone,callback:function(t){e.$set(e.ruleForm,"telephone",t)},expression:"ruleForm.telephone"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"用户名称",prop:"name"}},[o("el-input",{attrs:{placeholder:"请输入用户名称"},model:{value:e.ruleForm.name,callback:function(t){e.$set(e.ruleForm,"name",t)},expression:"ruleForm.name"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"所属机构",prop:"schoolName"}},[o("el-input",{attrs:{placeholder:"请输入用户所属机构"},model:{value:e.ruleForm.schoolName,callback:function(t){e.$set(e.ruleForm,"schoolName",t)},expression:"ruleForm.schoolName"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"性别"}},[o("el-radio",{attrs:{label:"1"},model:{value:e.ruleForm.sex,callback:function(t){e.$set(e.ruleForm,"sex",t)},expression:"ruleForm.sex"}},[e._v("男")]),e._v(" "),o("el-radio",{attrs:{label:"0"},model:{value:e.ruleForm.sex,callback:function(t){e.$set(e.ruleForm,"sex",t)},expression:"ruleForm.sex"}},[e._v("女")])],1),e._v(" "),o("el-form-item",{attrs:{label:"角色",prop:"roleId"}},[o("el-radio",{attrs:{label:"0"},model:{value:e.ruleForm.roleId,callback:function(t){e.$set(e.ruleForm,"roleId",t)},expression:"ruleForm.roleId"}},[e._v("老师")]),e._v(" "),o("el-radio",{attrs:{label:"1"},model:{value:e.ruleForm.roleId,callback:function(t){e.$set(e.ruleForm,"roleId",t)},expression:"ruleForm.roleId"}},[e._v("管理员")])],1)],1),e._v(" "),o("div",{staticClass:"dialog-footer",staticStyle:{"text-align":"center","margin-bottom":"10px"},attrs:{slot:"footer"},slot:"footer"},[o("el-button",{staticStyle:{width:"180px"},attrs:{type:"primary"},on:{click:function(t){e.submitForm("ruleForm")}}},[e._v("提交")]),e._v(" "),o("el-button",{staticStyle:{width:"180px"},on:{click:function(t){e.resetForm("ruleForm")}}},[e._v("取消")])],1),e._v(" "),"新增用户"==e.title?o("div",{staticClass:"dialog-footer",staticStyle:{"text-align":"center",color:"#5d5b5b","font-size":"14px"},attrs:{slot:"footer"},slot:"footer"},[o("span",[e._v("新增用户状态默认为正常")])]):e._e()],1)],1)},staticRenderFns:[]};var i=o("VU/8")(a,n,!1,function(e){o("bWfh"),o("XcIJ")},"data-v-d3c96944",null);t.default=i.exports}});