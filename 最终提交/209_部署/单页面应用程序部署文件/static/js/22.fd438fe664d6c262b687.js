webpackJsonp([22],{Us1u:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("c/Tr"),i=n.n(r),a=n("Gu7T"),o=n.n(a),l={data:function(){return{experienceForm:{levels:[{value:""}],attendances:[{ratio1:"0",ratio2:""}],checkExperience:"",workExperience:"",distance:-1},experienceFormInit:{levels:[{value:0},{value:1},{value:2},{value:3},{value:4}],attendances:[{ratio1:"0",ratio2:"0"},{ratio1:"0",ratio2:"20"},{ratio1:"20",ratio2:"50"},{ratio1:"50",ratio2:"70"},{ratio1:"70",ratio2:"100"}],checkExperience:2,workExperience:2,distance:0}}},created:function(){this.getData()},methods:{getData:function(){var e=this;this.$http.get("/api/systems").then(function(t){e.experienceForm.checkExperience=parseInt(t.data.attend_exp),e.experienceForm.workExperience=parseInt(t.data.activity_exp),e.experienceForm.distance=parseInt(t.data.distance),e.experienceForm.attendances=t.data.attendence,e.experienceForm.levels=t.data.levels},function(t){e.$router.push({path:"/"+t})})},removeLevelAndAttend:function(e){var t=this.experienceForm.attendances.indexOf(e);-1!==t&&this.experienceForm.attendances.splice(t,1),-1!==t&&this.experienceForm.levels.splice(t,1)},addLevelAndAttend:function(){this.experienceForm.levels.push({value:"",key:Date.now()+0}),this.experienceForm.attendances.push({ratio1:this.experienceForm.attendances[this.experienceForm.attendances.length-1].ratio2,ratio2:"",key:Date.now()+1})},onSubmit:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;var n=[];for(var r in t.experienceForm.levels)n.push(t.experienceForm.levels[r].value);if(t.isContinuityNum(n)){var i=[];for(var r in t.experienceForm.levels)i.push({level:t.experienceForm.levels[r].value,ratio:t.experienceForm.attendances[r].ratio2});var a={attend_exp:t.experienceForm.checkExperience,activity_exp:t.experienceForm.workExperience,distance:t.experienceForm.distance,detail:i};t.$http.patch("/api/systems",a).then(function(e){"1"==e.data.respCode?t.$alert("成功","成功",{confirmButtonText:"确定"}):t.$alert(e.data.respCode,"失败",{confirmButtonText:"确定"})},function(e){t.$router.push({path:"/"+e})})}else t.$alert("设置的等级不连续","失败",{confirmButtonText:"确定"})})},resetForm:function(e){this.experienceForm=this.experienceFormInit,this.onSubmit(e)},isContinuityNum:function(e){var t=[],n=(t=e instanceof Array?[].concat(o()(e)):i()(e.toString()))[0],r=!0;for(var a in t){if(t[a]!=n){r=!1;break}n++}return r}}},c={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"app-container"},[n("div",{staticClass:"form-style"},[n("el-form",{ref:"experienceForm",staticStyle:{width:"80%",margin:"0 20px"},attrs:{model:e.experienceForm,"label-width":"150px"}},[n("el-form-item",{attrs:{label:"签到经验值：",prop:"checkExperience",rules:[{required:!0,message:"签到经验值不能为空"},{type:"number",message:"签到经验值必须为数字值"}]}},[n("el-input",{model:{value:e.experienceForm.checkExperience,callback:function(t){e.$set(e.experienceForm,"checkExperience",e._n(t))},expression:"experienceForm.checkExperience"}})],1),e._v(" "),n("el-row",[n("el-col",{attrs:{span:11}},e._l(e.experienceForm.levels,function(t,r){return n("el-form-item",{key:t.key,attrs:{label:"出勤等级"+(r+1),prop:"levels."+r+".value",rules:[{required:!0,message:"等级不能为空",trigger:"blur"},{type:"number",message:"等级必须为数字值"}]}},[n("el-input",{model:{value:t.value,callback:function(n){e.$set(t,"value",e._n(n))},expression:"level.value"}},[n("template",{slot:"prepend"},[e._v("LV")])],2)],1)})),e._v(" "),n("el-col",{attrs:{span:13}},e._l(e.experienceForm.attendances,function(t,r){return n("el-form-item",{key:t.key,attrs:{label:"出勤率"+(r+1),prop:"attendances."+r+".ratio2",rules:{required:!0,message:"出勤率不能为空",trigger:"blur"}}},[n("el-row",{attrs:{gutter:20}},[n("el-col",{attrs:{span:18}},[n("el-row",{attrs:{gutter:20}},[n("el-col",{attrs:{span:11}},[n("el-input",{attrs:{disabled:""},model:{value:t.ratio1,callback:function(n){e.$set(t,"ratio1",n)},expression:"attendance.ratio1"}},[n("template",{staticStyle:{padding:"0 10px"},slot:"append"},[e._v("%")])],2)],1),e._v(" "),n("el-col",{attrs:{span:1}},[e._v("-")]),e._v(" "),n("el-col",{attrs:{span:11}},[n("el-input",{attrs:{disabled:!(r+1==e.experienceForm.levels.length)},model:{value:t.ratio2,callback:function(n){e.$set(t,"ratio2",n)},expression:"attendance.ratio2"}},[n("template",{staticStyle:{padding:"0 10px"},slot:"append"},[e._v("%")])],2)],1)],1)],1),e._v(" "),n("el-col",{staticStyle:{"margin-right":"25px"},attrs:{span:1}},[n("i",{directives:[{name:"show",rawName:"v-show",value:r+1==e.experienceForm.levels.length&&""!=t.ratio2,expression:"index+1==experienceForm.levels.length&&attendance.ratio2!=''"}],staticClass:"el-icon-circle-plus",staticStyle:{color:"#409eff","font-size":"27px"},on:{click:function(t){e.addLevelAndAttend()}}})]),e._v(" "),n("el-col",{attrs:{span:1}},[n("i",{directives:[{name:"show",rawName:"v-show",value:r+1==e.experienceForm.levels.length&&e.experienceForm.levels.length>1,expression:"index+1==experienceForm.levels.length && experienceForm.levels.length>1 "}],staticClass:"el-icon-remove",staticStyle:{color:"red","font-size":"27px"},on:{click:function(n){n.preventDefault(),e.removeLevelAndAttend(t)}}})])],1)],1)}))],1),e._v(" "),n("el-form-item",{attrs:{label:"签到距离KM：",prop:"distance",rules:[{required:!0,message:"距离不能为空"},{type:"number",message:"距离必须为整数值"}]}},[n("el-tooltip",{attrs:{effect:"dark",placement:"top"}},[n("div",{attrs:{slot:"content"},slot:"content"},[e._v("\n            表示学生只有在老师一定距离范围内签到才可签到成功。\n            "),n("br"),e._v("默认0，表示不限定距离。\n          ")]),e._v(" "),n("el-input",{model:{value:e.experienceForm.distance,callback:function(t){e.$set(e.experienceForm,"distance",e._n(t))},expression:"experienceForm.distance"}})],1)],1),e._v(" "),n("el-form-item",{staticStyle:{"text-align":"center"}},[n("el-button",{staticStyle:{width:"40%"},attrs:{type:"primary"},on:{click:function(t){e.onSubmit("experienceForm")}}},[e._v("保存")]),e._v(" "),n("el-button",{staticStyle:{width:"40%"},on:{click:function(t){e.resetForm("experienceForm")}}},[e._v("重置为初始值")])],1)],1)],1)])},staticRenderFns:[]};var s=n("VU/8")(l,c,!1,function(e){n("aiJl")},null,null);t.default=s.exports},aiJl:function(e,t,n){var r=n("cIK2");"string"==typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);n("rjj0")("5f546a8f",r,!0)},cIK2:function(e,t,n){(e.exports=n("FZ+f")(!1)).push([e.i,"\n.el-input-group__append {\n  padding: 0 10px !important;\n}\n",""])}});