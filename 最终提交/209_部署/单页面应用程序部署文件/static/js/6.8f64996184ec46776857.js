webpackJsonp([6],{"6JqB":function(t,e,a){(t.exports=a("FZ+f")(!1)).push([t.i,"\n.el-pagination[data-v-fccfc856] {\r\n  text-align: center !important;\r\n  margin: 20px 0 !important;\n}\n.dashboard-editor-container[data-v-fccfc856] {\r\n  float: left;\r\n  width: 20%;\n}\r\n",""])},"7YO3":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("mvHQ"),o=a.n(i),l={data:function(){return{list:[],listLoading:!1,multipleSelection:[],dialogFormVisible:!1,totalNum:0,pageSize:10,searchForm:{name:""},page:1,data:[],id:1,defaultProps:{children:"children",label:"label"},editForm:{name:"",code:"",id:""},editRules:{name:[{required:!0,message:"请输入名称",trigger:"blur"}],code:[{required:!0,message:"请输入编号",trigger:"blur"}]},addForm:{name:"",code:""},addRules:{name:[{required:!0,message:"请输入名称",trigger:"blur"}],code:[{required:!0,message:"请输入编号",trigger:"blur"},{min:2,max:2,message:"请输入两个字符",trigger:"blur"}]},formLabelWidth:"100px",title:"新增",isAdd:!0,selectTree:"",selectTreeId:"0",isAddSchool:!1}},created:function(){this.getAllData(this.page)},methods:{handleNodeClick:function(t){var e=this;this.list=[],this.listLoading=!0,this.page=1,this.$http.get("/api/schools?id="+t.id+"&page="+this.page).then(function(t){e.list=t.data.records,e.listLoading=!1,e.totalNum=t.data.total},function(t){e.$router.push({path:"/"+t})}),this.selectTree=t.code,this.selectTreeId=t.id},handleSelectionChange:function(t){this.multipleSelection=t},deleteData:function(t){var e=this,a=[];a.push(t.id),console.log(a),this.$confirm("确定要删除选择的院校？","删除院校",{confirmButtonText:"确定",cancelButtonText:"取消",type:"info"}).then(function(){var t=a;e.$http.delete("/api/schools?ids="+t).then(function(t){"1"==t.data.respCode?(e.$alert("删除成功","成功",{confirmButtonText:"确定"}),e.page=1,e.getAllData(e.page)):(e.$alert(t.data.respCode,"失败",{confirmButtonText:"确定"}),e.getAllData(e.page)),e.listLoading=!1},function(t){e.$router.push({path:"/"+t})})}).catch(function(){})},deleteDataBatch:function(){var t=this;if(0==this.multipleSelection.length)this.$alert("请至少选中一条数据","批量删除",{confirmButtonText:"确定"});else{var e=[];for(var a in this.multipleSelection)e.push(this.multipleSelection[a].id);console.log(e),this.$confirm("确定要删除选择的院校？","删除院校",{confirmButtonText:"确定",cancelButtonText:"取消",type:"info"}).then(function(){var a=e;t.$http.delete("/api/schools?ids="+a).then(function(e){"1"==e.data.respCode?(t.$alert("删除成功","成功",{confirmButtonText:"确定"}),t.page=1,t.getAllData(t.page)):(t.$alert(e.data.respCode,"失败",{confirmButtonText:"确定"}),t.getAllData(t.page)),t.listLoading=!1},function(e){t.$router.push({path:"/"+e})})}).catch(function(){})}},searchData:function(){var t=this;this.list=[],this.listLoading=!0,this.page=1,this.$http.get("/api/schools?name="+this.searchForm.name+"&page="+this.page).then(function(e){t.list=e.data.records,t.listLoading=!1,t.totalNum=e.data.total},function(e){t.$router.push({path:"/"+e})})},getAllData:function(t){var e=this;this.selectTree="",this.selectTreeId="0",this.list=[],this.listLoading=!0,this.page=t,this.$http.get("/api/schools?page="+t).then(function(t){e.list=t.data.records,e.listLoading=!1,e.totalNum=t.data.total},function(t){e.$router.push({path:"/"+t})}),this.$http.get("/api/schools").then(function(t){e.data=t.data,console.log("res.data = "+o()(t.data))},function(t){e.$router.push({path:"/"+t})})},reset:function(){this.addForm.name="",this.addForm.code=""},addData:function(){this.reset(),this.title="新增",this.isAdd=!0,""!=this.selectTree?this.isAddSchool=!1:this.isAddSchool=!0,this.dialogFormVisible=!0},submitForm:function(t){var e=this;this.$refs[t].validate(function(t){if(t)if(e.dialogFormVisible=!1,1==e.isAdd){var a={code:e.selectTree+e.addForm.code,name:e.addForm.name,parent_id:e.selectTreeId};e.$http.post("/api/schools",a).then(function(t){"1"==t.data.respCode?(e.$alert("添加成功","成功",{confirmButtonText:"确定"}),e.getAllData(e.page)):(e.$alert(t.data.respCode,"失败",{confirmButtonText:"确定"}),e.getAllData(e.page)),e.listLoading=!1},function(t){e.$router.push({path:"/"+t})})}else{a={name:e.editForm.name,id:e.editForm.id};e.$http.patch("/api/schools",a).then(function(t){"1"==t.data.respCode?(e.$alert("修改成功","成功",{confirmButtonText:"确定"}),e.getAllData(e.page)):(e.$alert(t.data.respCode,"失败",{confirmButtonText:"确定"}),e.getAllData(e.page)),e.listLoading=!1},function(t){e.$router.push({path:"/"+t})})}})},resetForm:function(t){this.dialogFormVisible=!1,this.$refs[t].resetFields(),this.getAllData(this.page)},handleCurrentChange:function(t){this.page=t,this.getAllData(this.page)},resetData:function(){this.searchForm.name="",this.page=1,this.getAllData(this.page)},editData:function(t){this.title="编辑",this.isAdd=!1,this.editForm.code=t.code,this.editForm.name=t.name,this.editForm.id=t.id,this.dialogFormVisible=!0}}},n={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"app-container"},[a("div",{staticClass:"form-style"},[a("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:t.searchForm}},[a("el-form-item",[a("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-plus"},on:{click:function(e){t.addData()}}},[t._v("新增")])],1),t._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"danger",size:"small",icon:"el-icon-delete"},on:{click:function(e){t.deleteDataBatch()}}},[t._v("删除")])],1),t._v(" "),a("el-form-item",{staticStyle:{float:"right"}},[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(e){t.resetData()}}},[t._v("重置")])],1),t._v(" "),a("el-form-item",{staticStyle:{float:"right"}},[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(e){t.searchData()}}},[t._v("查询")])],1),t._v(" "),a("el-form-item",{staticStyle:{float:"right"},attrs:{label:"名称："}},[a("el-input",{attrs:{placeholder:"请输入名称",size:"small"},model:{value:t.searchForm.name,callback:function(e){t.$set(t.searchForm,"name",e)},expression:"searchForm.name"}})],1)],1),t._v(" "),a("div",[a("div",{staticClass:"dashboard-editor-container"},[a("el-button",{staticStyle:{width:"100%","margin-bottom":"20px"},attrs:{type:"primary",size:"small"}},[t._v("学校组织机构")]),t._v(" "),a("el-tree",{attrs:{data:t.data,props:t.defaultProps,"node-key":"id","default-expanded-keys":[t.id],accordion:""},on:{"node-click":t.handleNodeClick}})],1),t._v(" "),a("div",{staticStyle:{width:"75%",float:"right"}},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.listLoading,expression:"listLoading"}],ref:"multipleTable",attrs:{data:t.list,"element-loading-text":"Loading",fit:"",height:"60vh","highlight-current-row":"","tooltip-effect":"dark","header-cell-style":{background:"#eef1f6",color:"#606266"}},on:{"selection-change":t.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"50"}}),t._v(" "),a("el-table-column",{attrs:{label:"序号",type:"index",width:"50",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s((t.page-1)*t.pageSize+e.$index+1))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"编号","min-width":"50",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.code))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"名称","min-width":"100",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.name))])]}}])}),t._v(" "),a("el-table-column",{attrs:{align:"center",label:"操作","min-width":"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",[a("el-link",{attrs:{type:"primary"},on:{click:function(a){t.editData(e.row)}}},[t._v("编辑")]),t._v(" "),a("el-divider",{attrs:{direction:"vertical"}}),t._v(" "),a("el-link",{attrs:{type:"danger"},on:{click:function(a){t.deleteData(e.row)}}},[t._v("删除")])],1)]}}])})],1),t._v(" "),0!=t.totalNum?a("el-pagination",{attrs:{background:"",layout:"total, prev, pager, next",total:t.totalNum,"page-size":t.pageSize},on:{"current-change":t.handleCurrentChange}}):t._e()],1)])],1),t._v(" "),a("el-dialog",{attrs:{title:t.title,visible:t.dialogFormVisible},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[t.isAdd?a("el-form",{ref:"addForm",attrs:{model:t.addForm,rules:t.addRules}},[a("el-form-item",{attrs:{label:"编号","label-width":t.formLabelWidth,prop:"code"}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:t.addForm.code,callback:function(e){t.$set(t.addForm,"code",e)},expression:"addForm.code"}},[t.isAddSchool?t._e():a("template",{slot:"prepend"},[t._v(t._s(t.selectTree))])],2)],1),t._v(" "),a("el-form-item",{attrs:{label:"名称","label-width":t.formLabelWidth,prop:"name"}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:t.addForm.name,callback:function(e){t.$set(t.addForm,"name",e)},expression:"addForm.name"}})],1)],1):a("el-form",{ref:"editForm",attrs:{model:t.editForm,rules:t.editRules}},[a("el-form-item",{attrs:{label:"编号","label-width":t.formLabelWidth,prop:"code"}},[a("el-input",{attrs:{autocomplete:"off",disabled:""},model:{value:t.editForm.code,callback:function(e){t.$set(t.editForm,"code",e)},expression:"editForm.code"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"名称","label-width":t.formLabelWidth,prop:"name"}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:t.editForm.name,callback:function(e){t.$set(t.editForm,"name",e)},expression:"editForm.name"}})],1)],1),t._v(" "),t.isAdd?a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.resetForm("addForm")}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.submitForm("addForm")}}},[t._v("确 定")])],1):a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.resetForm("editForm")}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.submitForm("editForm")}}},[t._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var r=a("VU/8")(l,n,!1,function(t){a("E0vO"),a("KG2u")},"data-v-fccfc856",null);e.default=r.exports},DhhU:function(t,e,a){(t.exports=a("FZ+f")(!1)).push([t.i,"\n.el-table__header {\r\n  width: auto !important;\n}\n.el-table__body {\r\n  width: auto !important;\n}\n.app-container {\r\n  background-color: #f0f2f5;\r\n  min-height: 100vh;\r\n  height: 100%;\n}\n.form-style {\r\n  background: #fff;\r\n  padding: 20px;\r\n  min-height: 85vh;\n}\r\n",""])},E0vO:function(t,e,a){var i=a("6JqB");"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);a("rjj0")("8fffa99c",i,!0)},KG2u:function(t,e,a){var i=a("DhhU");"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);a("rjj0")("8704bd08",i,!0)}});