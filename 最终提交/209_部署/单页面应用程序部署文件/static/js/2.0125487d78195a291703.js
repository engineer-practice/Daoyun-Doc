webpackJsonp([2],{"/Gcy":function(e,r,t){(e.exports=t("FZ+f")(!1)).push([e.i,"\n.el-upload {\n  display: block !important;\n  position: relative !important;\n  margin-bottom: 20px;\n}\n",""])},IWTn:function(e,r,t){(e.exports=t("FZ+f")(!1)).push([e.i,"\n.dashboard-editor-container[data-v-2f2f5ca6] {\n  padding: 20px;\n  background-color: #f0f2f5;\n  height: 100vh;\n}\n.form-style[data-v-2f2f5ca6] {\n  background: #fff;\n  padding: 20px;\n}\n.form1[data-v-2f2f5ca6] {\n  border: 1px solid #c5c5c5;\n  padding: 20px;\n}\n.form2[data-v-2f2f5ca6] {\n  border: 1px solid #c5c5c5;\n  padding: 20px;\n}\n.avatar-uploader .el-upload[data-v-2f2f5ca6] {\n  border: 1px dashed #d9d9d9;\n  border-radius: 6px;\n  cursor: pointer;\n  position: relative;\n  overflow: hidden;\n}\n.avatar-uploader .el-upload[data-v-2f2f5ca6]:hover {\n  border-color: #409eff;\n}\n.avatar-uploader-icon[data-v-2f2f5ca6] {\n  font-size: 28px;\n  color: #8c939d;\n  width: 80px;\n  height: 80px;\n  line-height: 80px;\n  text-align: center;\n  border: 1px dashed;\n}\n.avatar[data-v-2f2f5ca6] {\n  width: 80px;\n  height: 80px;\n  display: block;\n  margin: 0 auto;\n}\n",""])},p5YN:function(e,r,t){var o=t("IWTn");"string"==typeof o&&(o=[[e.i,o,""]]),o.locals&&(e.exports=o.locals);t("rjj0")("4bd20752",o,!0)},sg2c:function(e,r,t){var o=t("/Gcy");"string"==typeof o&&(o=[[e.i,o,""]]),o.locals&&(e.exports=o.locals);t("rjj0")("1b112d31",o,!0)},yl3r:function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var o=t("mvHQ"),a=t.n(o),l={data:function(){var e=this;return{ruleForm:{email:"",nickname:"",exp:"",name:"",birth:"",phone:"",sno:"",sex:"1",type:1,school:[]},ruleForm2:{oldPass:"",pass:"",checkPass:""},rules:{name:[{required:!0,message:"请输入用户名",trigger:"blur"}],nickname:[{required:!0,message:"请输入昵称",trigger:"blur"}],school:[{required:!1,validator:function(e,r,t){""===r?t(new Error("请选择学校及学院")):t()},trigger:"change"}],phone:[{validator:function(e,r,t){if(r){var o=/^1[3|4|5|7|8][0-9]\d{8}$/;if(console.log(o.test(r)),!o.test(r))return t(new Error("请输入正确的手机号"));t()}else t()},trigger:"blur"}]},rules2:{pass:[{validator:function(e,r,t){""===r?t(new Error("请输入密码")):(/^(?!^[0-9]+$)(?!^[A-z]+$)(?!^[^A-z0-9]+$)^[^\s\u4e00-\u9fa5]{6,16}$/.exec(r)||t(new Error("6-16位，由数字、英文、符号三种类型构成，至少包含两种类型字符")),t())},trigger:"blur"}],checkPass:[{validator:function(r,t,o){""===t?o(new Error("请再次输入密码")):t!==e.ruleForm2.pass?o(new Error("两次输入密码不一致!")):o()},trigger:"blur"}]},options:[],imageUrl:""}},created:function(){this.showSchool(),this.showUserInfo()},methods:{showUserInfo:function(){var e=this;this.$http.get("/api/user/info?email="+localStorage.getItem("account")).then(function(r){e.ruleForm.email=localStorage.getItem("account"),e.ruleForm.name=r.data.name,e.ruleForm.sno=r.data.sno,e.ruleForm.nickname=r.data.nickname,e.ruleForm.sex="男",e.ruleForm.role=r.data.role,""!=r.data.school&&"0"!=r.data.school&&(e.ruleForm.school="福州大学"),console.log(e.ruleForm.school),e.ruleForm.birth=r.data.birth,e.ruleForm.phone=r.data.telphone,e.ruleForm.exp=r.data.exp},function(r){e.$router.push({path:"/"+r})})},showSchool:function(){var e=this;this.$http.get("/api/schools?info=1").then(function(r){console.log("res.data = "+a()(r.data));var t=[];for(var o in r.data)t.push(r.data[o]);e.options=t},function(r){e.$router.push({path:"/"+r})})},submitForm:function(e){var r=this;this.$refs[e].validate(function(e){if(e){var t={email:r.ruleForm.email,nickname:r.ruleForm.nickname,sex:r.ruleForm.sex,school:r.ruleForm.school,telphone:r.ruleForm.phone,birth:r.ruleForm.birth,name:r.ruleForm.name,sno:r.ruleForm.sno,image:"0"};return r.$http.put("/api/user/info",t).then(function(e){"1"==e.data.respCode?r.$alert("用户信息修改成功","成功",{confirmButtonText:"确定"}):r.$alert(e.data.respCode,"失败",{confirmButtonText:"确定"})},function(e){r.$router.push({path:"/"+e})}),!1}})},resetForm:function(e){this.$refs[e].resetFields(),this.ruleForm.name1="",this.ruleForm.sex="1"},submitForm2:function(e){var r=this;this.$refs[e].validate(function(e){if(!e)return r.$alert("有必填项未填写或者填写错误","警告",{confirmButtonText:"确定"}),!1;var t={telephone:localStorage.getItem("roleEmail"),newpassword1:r.ruleForm2.pass,newpassword2:r.ruleForm2.checkPass,oldpassword:r.ruleForm2.oldPass};console.log("this.localStorage = "+a()(localStorage)),console.log("修改密码data = "+a()(t)),r.$http.post("/api/user/updatePassword",t).then(function(e){"1"==e.data.respCode?(r.$alert("密码修改成功，跳转到登录页重新登录","成功",{confirmButtonText:"确定"}),localStorage.removeItem("Authorization"),localStorage.removeItem("isLogin"),r.$router.push("/login")):r.$alert(e.data.respCode,"失败",{confirmButtonText:"确定"})},function(e){r.$router.push({path:"/"+e})})})},resetForm2:function(e){this.$refs[e].resetFields(),this.ruleForm2.oldPass=""},handleAvatarSuccess:function(e,r){this.imageUrl=URL.createObjectURL(r.raw)},beforeAvatarUpload:function(e){var r="image/jpeg"===e.type,t=e.size/1024/1024<2;return r||this.$message.error("上传头像图片只能是 JPG 格式!"),t||this.$message.error("上传头像图片大小不能超过 2MB!"),r&&t},handleChange:function(e){this.ruleForm.school="";for(var r=0;r<e.length;r++)this.ruleForm.school+=e[r],r!=e.length-1&&(this.ruleForm.school+="/")}}},n={render:function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("div",{staticClass:"dashboard-editor-container"},[t("el-row",{staticClass:"form-style"},[t("el-col",{staticClass:"form1",attrs:{span:11}},[t("el-button",{staticStyle:{width:"100%","margin-bottom":"20px"},attrs:{type:"primary"}},[e._v("个人信息")]),e._v(" "),t("el-form",{ref:"ruleForm",staticStyle:{width:"90%"},attrs:{"label-width":"80px",model:e.ruleForm,rules:e.rules}},[t("el-form-item",{attrs:{label:"账号/邮箱"}},[t("el-input",{attrs:{disabled:""},model:{value:e.ruleForm.email,callback:function(r){e.$set(e.ruleForm,"email",r)},expression:"ruleForm.email"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"名称",prop:"name"}},[t("el-input",{attrs:{placeholder:"请输入名称"},model:{value:e.ruleForm.name,callback:function(r){e.$set(e.ruleForm,"name",r)},expression:"ruleForm.name"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"工号",prop:"sno"}},[t("el-input",{attrs:{placeholder:"请输入工号"},model:{value:e.ruleForm.sno,callback:function(r){e.$set(e.ruleForm,"sno",r)},expression:"ruleForm.sno"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"昵称",prop:"nickname"}},[t("el-input",{attrs:{placeholder:"请输入昵称"},model:{value:e.ruleForm.nickname,callback:function(r){e.$set(e.ruleForm,"nickname",r)},expression:"ruleForm.nickname"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"性别"}},[t("el-radio-group",{model:{value:e.ruleForm.sex,callback:function(r){e.$set(e.ruleForm,"sex",r)},expression:"ruleForm.sex"}},[t("el-radio",{attrs:{label:"0"}},[e._v("男")]),e._v(" "),t("el-radio",{attrs:{label:"1"}},[e._v("女")])],1)],1),e._v(" "),t("el-form-item",{attrs:{label:"学院",prop:"school"}},[t("el-cascader",{attrs:{options:e.options},on:{change:e.handleChange},model:{value:e.ruleForm.school,callback:function(r){e.$set(e.ruleForm,"school",r)},expression:"ruleForm.school"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"出生日期"}},[t("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd",type:"date",placeholder:"选择日期"},model:{value:e.ruleForm.birth,callback:function(r){e.$set(e.ruleForm,"birth",r)},expression:"ruleForm.birth"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"用户角色"}},["0"==e.ruleForm.role?t("el-tag",{attrs:{type:"success"}},[e._v("老师")]):e._e(),e._v(" "),"1"==e.ruleForm.role?t("el-tag",{attrs:{type:"success"}},[e._v("管理员")]):e._e(),e._v(" "),"2"==e.ruleForm.role?t("el-tag",{attrs:{type:"success"}},[e._v("超级管理员")]):e._e()],1),e._v(" "),t("el-form-item",{attrs:{label:"经验值"}},[t("el-input",{attrs:{disabled:""},model:{value:e.ruleForm.exp,callback:function(r){e.$set(e.ruleForm,"exp",r)},expression:"ruleForm.exp"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"电话号码",prop:"phone"}},[t("el-input",{model:{value:e.ruleForm.phone,callback:function(r){e.$set(e.ruleForm,"phone",r)},expression:"ruleForm.phone"}})],1),e._v(" "),t("el-form-item",[t("el-button",{staticStyle:{width:"40%"},attrs:{type:"primary"},on:{click:function(r){e.submitForm("ruleForm")}}},[e._v("提交")]),e._v(" "),t("el-button",{staticStyle:{width:"40%"},on:{click:function(r){e.resetForm("ruleForm")}}},[e._v("重置")])],1)],1)],1),e._v(" "),t("el-col",{staticClass:"form2",attrs:{span:11,offset:1}},[t("el-button",{staticStyle:{width:"100%","margin-bottom":"20px"},attrs:{type:"primary"}},[e._v("密码修改")]),e._v(" "),t("el-form",{ref:"ruleForm2",staticClass:"demo-ruleForm",staticStyle:{width:"90%"},attrs:{model:e.ruleForm2,"status-icon":"",rules:e.rules2,"label-width":"100px"}},[t("el-form-item",{attrs:{label:"原密码",required:""}},[t("el-input",{model:{value:e.ruleForm2.oldPass,callback:function(r){e.$set(e.ruleForm2,"oldPass",r)},expression:"ruleForm2.oldPass"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"新密码",prop:"pass",required:""}},[t("el-input",{model:{value:e.ruleForm2.pass,callback:function(r){e.$set(e.ruleForm2,"pass",r)},expression:"ruleForm2.pass"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"确认密码",prop:"checkPass",required:""}},[t("el-input",{model:{value:e.ruleForm2.checkPass,callback:function(r){e.$set(e.ruleForm2,"checkPass",r)},expression:"ruleForm2.checkPass"}})],1),e._v(" "),t("el-form-item",[t("el-button",{staticStyle:{width:"40%"},attrs:{type:"primary"},on:{click:function(r){e.submitForm2("ruleForm2")}}},[e._v("提交")]),e._v(" "),t("el-button",{staticStyle:{width:"40%"},on:{click:function(r){e.resetForm2("ruleForm2")}}},[e._v("重置")])],1)],1)],1)],1)],1)},staticRenderFns:[]};var s=t("VU/8")(l,n,!1,function(e){t("p5YN"),t("sg2c")},"data-v-2f2f5ca6",null);r.default=s.exports}});